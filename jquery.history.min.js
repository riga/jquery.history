/*!
 * jQuery History Plugin v0.2
 * https://github.com/riga/jquery.history
 *
 * Copyright 2012, Marcel Rieger
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://www.opensource.org/licenses/mit-license
 * http://www.opensource.org/licenses/GPL-3.0
 */
var _history={instance:null,callbacks:jQuery.Callbacks()};
jQuery.History=function(k,d){if(k&&(k.fire||jQuery.isFunction(k))){if(d||d===undefined){_history.callbacks.add(k.fire||k);}else{_history.callbacks=k.fire?k:jQuery.Callbacks().add(k);
}}if(_history.instance){return _history.instance;}var l,i=function(p,o){if(!jQuery.isPlainObject(p)){p=jQuery.extend(true,{url:p},o);}o=p;window.history.pushState(o,"",encodeURI(o.url));
h().fire(o);return l;},j=function(o,q,p){if(q||q===undefined){o=jQuery.extend(true,c(),o);}window.history.replaceState(o);if(p){h().fire(o);}return l;},g=function(){window.history.forward();
return l;},f=function(){window.history.back();return l;},e=function(o){window.history.go(o);return l;},c=function(){return window.history.state;},n=function(){return window.history.length;
},b=function(){return _history.callbacks.fired();},m=function(){var o=jQuery.Deferred();_history.callbacks.add(o.resolve);return o.promise();},h=function(){return _history.callbacks;
},a=function(o){if(!o||!o.originalEvent){return;}h().fire(o.originalEvent.state);};$(window).on("popstate",a);l={push:i,modify:j,forward:g,back:f,go:e,state:c,size:n,promise:m,fired:b};
return _history.instance=l;};